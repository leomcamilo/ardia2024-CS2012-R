---
title: dissertação
author: Leonardo Camilo-da-Silva
date: today
execute: 
  freeze: true     # auto
  echo: false      # Ocultar códigos dos chunks
  warning: false   # Suprimir avisos
  message: false   # Suprimir mensagens
  error: false     # Suprimir erros
format: 
  # docx:
  #   toc: true            # Inclui o sumário
    # reference-doc: template.docx  # (Opcional) Modelo personalizado
    # Adicione outras opções específicas para o Word aqui
  pdf:
    template-partials: 
    - "before-body.tex" 
    latex_engine: xelatex
    mainfont: Times New Roman
    fontsize: 12pt
    lineheight: 1.5
    linestretch: 1.5
    geometry: "left=3cm, top=3cm, right=2cm, bottom=2cm"
    keep-tex: false
    number-sections: true
    include-in-header: config.tex        
crossref:
  fig-title: Figura   
  fig-prefix: figura
  tbl-title: Tabela     
  tbl-prefix: tabela
  lof-title: LISTA DE FIGURAS
  lot-title: LISTA DE TABELAS
  eq-title: Equação
  eq-prefix: equação
tbl-cap-location: top
fig-cap-location: top
lot: true
lof: true
listings: true
toc: true
toc-title: SUMÁRIO
toc-depth: 3
linkcolor: black
link-bibliography: false
editor: visual
# bibliography: references.bib
csl: abnt2023.csl
---

\newpage
\listofequations
\newpage

```{r}
library(tidyverse)
library(quantmod)
library(bidask)
library(readr)
library(purrr)
library(gt)
library(writexl)
```

```{r, include = FALSE, warning=FALSE, eval = FALSE}
# Importar códigos de empresas
company_codes <- read_csv("company_codes.csv")

# Função segura para baixar dados
safe_getSymbols <- safely(function(symbol) {
  getSymbols(symbol, src = "yahoo", from = "2017-01-01", to = "2024-10-30", auto.assign = FALSE)
})

# Baixar e salvar os preços de cada empresa em um arquivo CSV separado
company_codes$Company_Code %>% 
  walk(~ {
    result <- safe_getSymbols(.x)
    if (!is.null(result$result)) {
      data <- result$result
      data <- data.frame(Date = index(data), coredata(data))  # Adicionar a coluna de data
      write.csv(data, file = paste0("prices-companies/", .x, ".csv"), row.names = FALSE)
    } else {
      message("Erro ao baixar dados para: ", .x)
    }
  })
```

```{r, include = FALSE, show_col_types=FALSE}
# Importar códigos de empresas novamente
company_codes <- read_csv("company_codes.csv")

# Função para ler dados de arquivos CSV
read_company_data <- function(symbol) {
  file_path <- paste0("prices-companies/", symbol, ".csv")
  if (file.exists(file_path)) {
    read_csv(file_path)
  } else {
    message("Arquivo não encontrado para: ", symbol)
    NULL
  }
}

# Aplicar a função a todos os códigos de empresas usando purrr::map
company_data_list <- company_codes$Company_Code %>%
  map(~ read_company_data(.x))

# Função para remover linhas com valores NA de um dataframe
remove_na_rows <- function(df) {
  df %>% drop_na()
}

# Filtrar elementos NULL e remover linhas com valores NA
company_data_clean <- company_data_list %>%
  keep(~ !is.null(.x)) %>%
  map(~ remove_na_rows(.x)) %>%
  set_names(company_codes$Company_Code[!map_lgl(company_data_list, is.null)])

# Verificar quais downloads falharam
errors <- company_data_list %>%
  map("error") %>%
  keep(~ !is.null(.x))

if (length(errors) > 0) {
  print("Alguns downloads falharam:")
  print(errors)
} else {
  print("Todos os dados foram baixados com sucesso.")
}
```

```{=html}
<!--
Seleção dos 30% maiores e 30% menores volumes diários; Ou seja, maiores e menores liquidez.
-->
```

```{r}
# Agrupar as empresas com maiores médias de volume diários e selecionar os 30% maiores e 30% menores

# Calcular a média de volume para cada empresa
company_volumes <- company_data_clean %>%
  # Extrair a coluna de Volume (coluna 5) de cada dataframe
  map_dbl(~ mean(.x[[5]], na.rm = TRUE))

# Converter os resultados para um dataframe para melhor manipulação
company_volumes <- tibble(
  Company = names(company_data_clean),
  Mean_Volume = company_volumes
)

# Definir os percentis de 30% e 70%
volume_30 <- quantile(company_volumes$Mean_Volume, 0.3, na.rm = TRUE)
volume_70 <- quantile(company_volumes$Mean_Volume, 0.7, na.rm = TRUE)

# Atribuir cada empresa a um grupo com base na média de volume
company_volumes <- company_volumes %>%
  mutate(
    Group = case_when(
      Mean_Volume <= volume_30 ~ "Low Volume (Bottom 30%)",
      Mean_Volume > volume_70 ~ "High Volume (Top 30%)",
      TRUE ~ "Middle Volume (40%)"
    )
  )

# Empresas de baixo volume (Bottom 30%)
low_volume <- company_volumes %>%
  filter(Group == "Low Volume (Bottom 30%)") %>%
  pull(Company)

# Empresas de alto volume (Top 30%)
high_volume <- company_volumes %>%
  filter(Group == "High Volume (Top 30%)") %>%
  pull(Company)

# Criando um company_data_clean_high_volume e company_data_clean_low_volume
company_data_clean_high_volume <- company_data_clean[high_volume]
company_data_clean_low_volume <- company_data_clean[low_volume]

```

<!--Cálculo dos spreads EDGE e CS para toda a base-->

```{r}

# Função para converter dataframe em xts
convert_to_xts <- function(df) {
  xts(df[, -1], order.by = as.Date(df$Date))
}

# Converter os dataframes em company_data_clean para xts
company_data_clean_xts <- company_data_clean %>%
  map(~ convert_to_xts(.x))

# Calcular os spreads para cada empresa
company_spreads_EDGE <- company_data_clean_xts %>%
  map(~ bidask::spread(.x[, 1:4], method = "EDGE", width = 21, na.rm = TRUE))

# Calcular o spread com method "CS" para cada empresa em company_spreads
company_spreads_CS <- company_data_clean_xts %>%
  map(~ bidask::spread(.x[, 1:4], method = "CS", width = 21, na.rm = TRUE))

# Calcular o spread com method "AR" para cada empresa em company_spreads
company_spreads_AR <- company_data_clean_xts %>%
  map(~ bidask::spread(.x[, 1:4], method = "AR", width = 21, na.rm = TRUE))

# Combine os spreads em uma lista de listas
company_spreads_list <- list(
  EDGE = company_spreads_EDGE,
  CS = company_spreads_CS,
  AR = company_spreads_AR
)

# Obtenha os códigos das empresas
company_codes <- names(company_spreads_EDGE)

# Use pmap_dfr para combinar os spreads em um único dataframe
company_spreads_df <- pmap_dfr(
  .l = list(
    company_code = company_codes,
    edge = company_spreads_EDGE,
    cs = company_spreads_CS,
    ar = company_spreads_AR
  ),
  .f = function(company_code, edge, cs, ar) {
    data.frame(
      Company_Code = company_code,
      Date = index(edge),
      Spread_EDGE = as.numeric(edge),
      Spread_CS = as.numeric(cs),
      Spread_AR = as.numeric(ar)
    )
  }
)

# Calcular os spreads médios para cada ano em cada método e aplicar na variável company_spreads_year
company_spreads_year <- company_spreads_df %>%
  mutate(Year = year(Date)) %>%
  group_by(Company_Code, Year) %>%
  summarise(
    Spread_EDGE = mean(Spread_EDGE, na.rm = TRUE),
    Spread_CS = mean(Spread_CS, na.rm = TRUE),
    Spread_AR = mean(Spread_AR, na.rm = TRUE),
  )

# Filtrar o company_spread_df para high_volume e low_volume
company_spreads_high_volume <- company_spreads_year %>%
  filter(Company_Code %in% high_volume)
company_spreads_low_volume <- company_spreads_year %>%
  filter(Company_Code %in% low_volume)

# Filtrar o company_spread_year para os anos de 2017 a 2019 (antes da pandemia), para 2020 e 2021 (durante a pandemia) e para 2022 a 2024 (após a pandemia)
company_spreads_pre <- company_spreads_year %>%
  filter(Year %in% 2017:2019)
company_spreads_dur <- company_spreads_year %>%
  filter(Year %in% 2020:2021)
company_spreads_pos <- company_spreads_year %>%
  filter(Year %in% 2022:2024)


```

# Introdução geral

Aqui vou explicar que o que vai ter abaixo são dois trabalhos, uma Revisão Narrativa de Literatura e outro trabalho empírico (depois vem a introdução da RNL)

# Introdução para a revisão narrativa de literatura

A teoria econômica clássica explica que a formação de preços de mercado dos ativos ocorre como resultado do equilíbrio de Walras entre demanda e oferta. Entretanto, quando consideramos ativos de mercados financeiros, verificamos desvios de curto prazo relacionados a questões de microestrutura de mercado. O principal desvio microestrutural é o spread de compra e venda dos preços dos ativos. O objetivo deste trabalho é identificar o impacto do spread bid-ask na formação de preços de ativos financeiros, com foco no mercado de ações, através de uma Revisão Narrativa de Literatura (RNL), seguindo uma abordagem qualitativa e descritiva, que busca explorar e sintetizar os principais achados e teorias relacionadas ao tema. Diferente da Revisão Sistemática de Literatura (RSL), a RNL permite uma maior flexibilidade na seleção e análise dos estudos, proporcionando uma visão abrangente e interpretativa do fenômeno.

O spread de compra e venda, segundo Ardia, et. al (2023), pode ser definido como a distância medida de observações dos preços transacionados em relação ao preço fundamental não observado. O trabalho de Demsetz (1968), através de regressões MQO, foi o primeiro a avaliar a influência do spread nas operações realizadas na Bolsa de Nova Iorque (NYSE), identificando que custos de transação são significativos nas operações de compra e venda. A primeira abordagem de estimação do spread foi apresentada por Roll (1984), que infere esse componente por meio da covariância serial dos retornos dos preços do ativo. Em seguida, temos modelos com dados de alta frequência como Holden e Jacobsen (2014), Cattivelli e Pirino (2019), e modelos de baixa frequência derivados como aprimoramento do modelo de Roll (1984), como George et. al (1991), e Stoll (1989).

A amostra utilizada nesta Revisão compreende diversos estudos que abordam a medição do spread bid-ask tanto por meio de dados de alta frequência quanto de baixa frequência, com aplicações em diferentes mercados financeiros. A escolha dos artigos foi baseada na relevância e contribuição para a compreensão dos custos de transação e sua influência na formação dos preços dos ativos financeiros. Dentre os estudos selecionados, destacam-se as metodologias inovadoras e as diferentes abordagens teóricas e empíricas que enriquecem a análise do spread de compra e venda.

Os artigos analisados incluem trabalhos como o de Corwin e Schultz (2012), que apresentam um método para estimar o spread bid-ask utilizando dados de baixa frequência, e Roll (1984), que introduz um estimador baseado na covariância serial dos retornos. Além disso, estudos de alta frequência, como o de Huang (1997) e Holden e Jacobsen (2014), utilizam dados do livro de ordens para fornecer proxies explícitas do preço fundamental e calcular a distância dos preços de transação a partir dele. A amostra também abrange pesquisas recentes, como a de Ardia, et. al (2023), que aplicam estimadores generalizados de spread para analisar a volatilidade e a liquidez nos mercados de ações. A diversidade de metodologias e a aplicação em diferentes contextos de mercado proporcionam uma visão abrangente e detalhada sobre o impacto do spread bid-ask na formação de preços de ativos financeiros.

Os principais resultados indicam que o spread bid-ask desempenha um papel crucial na formação dos preços dos ativos financeiros, afetando tanto a liquidez quanto os custos de transação nos mercados financeiros. Estudos como os de Demsetz (1968) e Corwin e Schultz (2012) evidenciam que o spread bid-ask constitui uma parte significativa dos custos de transação. Esses custos influenciam diretamente a rentabilidade das operações de compra e venda, impactando a decisão dos investidores e, consequentemente, a dinâmica de mercado.

A relação inversa entre a liquidez de um ativo e seu spread bid-ask é destacada em pesquisas como as de Roll (1984) e Huang (1997), que demonstram que mercados com spreads menores tendem a ser mais líquidos, permitindo transações com menor impacto nos preços. Pesquisas contemporâneas, como as de Ardia, et. al (2023), indicam que o spread bid-ask está correlacionado com a volatilidade do mercado. Spreads mais altos frequentemente refletem uma maior incerteza sobre o valor fundamental dos ativos, resultando em maior volatilidade nos preços de mercado. A análise de diferentes mercados, como NYSE, AMEX, NASDAQ e mercados internacionais como Hong Kong e Índia, revela que o impacto do spread bid-ask varia conforme as características específicas de cada mercado, incluindo regulação, nível de transparência e estrutura de mercado.

O spread bid-ask é composto por três principais custos: custo de processamento das ordens ou transação, custo de assimetria de informação e custo de estoque ou inventário. O custo de processamento das ordens refere-se aos custos operacionais incorridos pelos market makers ao executar ordens de compra e venda, incluindo despesas administrativas, tecnológicas e de comunicação necessárias para manter a operação eficiente do mercado. O custo de assimetria de informação surge da incerteza enfrentada pelos market makers em relação à informação possuída pelos traders, levando-os a aumentar o spread para se proteger contra a possibilidade de negociar com traders informados. O custo de estoque ou inventário refere-se ao risco associado à manutenção de um inventário de ativos, com market makers ajustando o spread para compensar o risco de mudanças adversas nos preços dos ativos enquanto mantêm posições não equilibradas em seus livros. Esses componentes são fundamentais para entender a dinâmica do spread bid-ask e seu impacto na eficiência e liquidez dos mercados financeiros.

Este trabalho está estruturado em quatro seções principais, além da introdução. A próxima seção, Referencial Teórico, aborda os conceitos fundamentais e as teorias relacionadas ao spread bid-ask e à microestrutura de mercado, incluindo a Hipótese de Eficiência de Mercado e suas diversas formas. Esta seção revisa a literatura existente, destacando os principais estudos e suas contribuições para a compreensão do tema.

A terceira seção, Metodologia, descreve a abordagem metodológica adotada neste estudo. Utilizando uma Revisão Narrativa de Literatura (RNL), a seção detalha os critérios de seleção dos artigos, as fontes de dados consultadas e os métodos de análise qualitativa empregados. Esta abordagem permite uma exploração abrangente e interpretativa dos estudos selecionados, proporcionando uma visão detalhada sobre o impacto do spread bid-ask na formação de preços de ativos financeiros.

A quarta seção apresenta os Resultados da revisão, sintetizando os principais achados e teorias discutidos na literatura. Esta seção explora como diferentes metodologias de estimação do spread bid-ask, tanto com dados de alta frequência quanto de baixa frequência, contribuem para a compreensão da liquidez do mercado, dos custos de transação e da eficiência de mercado.

Finalmente, a seção de Conclusão e Discussão oferece um resumo dos principais resultados, discute suas implicações para a teoria e prática em finanças, e sugere direções para futuras pesquisas. Esta seção também reflete sobre as limitações do estudo e como elas podem ser abordadas em pesquisas futuras.

## Hipótese de eficiência de mercado

De acordo com Fama (1970) a Hipótese de eficiência de mercado propõe que os investidores do mercado irão fazer a melhor alocação de ativos possível com todas as informações relevantes que terão acesso, e os preços dos ativos irá refletir todas as informações disponíveis para os investidores, que se basearão na teoria econômica para realizar tais cálculos. Em Finanças, a HEM (Hipótese da Eficiência de Mercado) afirma que os mercados financeiros são "eficientes em relação à informação". Ou seja, um agente não consegue alcançar consistentemente retornos superiores à média do mercado, considerando as informações publicamente disponíveis no momento em que o investimento é feito (Fama, 1965; Malkiel, 2007; Jensen, 1978).

Existem três versões principais da hipótese: a fraca, a semi-forte e a forte. A hipótese fraca considera que os preços negociados para os bens (por exemplo, ações, obrigações ou propriedade) refletem toda a informação histórica disponível publicamente. Em seu trabalho seminal, Fama (1965) demonstra que os preços em mercados eficientes seguem um passeio aleatório, refletindo todas as informações históricas disponíveis, o que implica que os preços futuros não podem ser previstos com base em padrões passados.

A hipótese semi-forte afirma que os preços refletem todas as informações publicamente disponíveis e que os preços mudam instantaneamente para refletir as novas informações públicas. Esse conceito é extensivamente discutido no trabalho de Fama (1970), onde ele categoriza a eficiência de mercado em formas fraca, semi-forte e forte. A forma semi-forte da HEM sugere que nem mesmo a análise fundamentalista pode proporcionar vantagens, pois todas as informações disponíveis publicamente já estão incorporadas nos preços dos ativos. Estudos empíricos, como os de Malkiel (2007), corroboram essa visão ao demonstrar que as tentativas de prever movimentos de preços com base em análises fundamentais geralmente não resultam em retornos acima da média.

Embora a hipótese de eficiência de mercado proponha que os preços dos ativos refletem todas as informações disponíveis, o spread bid-ask é um fator crucial que pode introduzir ineficiências no mercado. Custos de transação elevados, informação assimétrica, baixa liquidez e problemas de microestrutura do mercado são elementos que podem ampliar o spread e impedir que os preços se ajustem rapidamente às novas informações. Isso sugere que, na prática, os mercados podem não ser tão eficientes quanto a teoria propõe, e os investidores precisam considerar esses fatores ao tomar decisões de investimento.

## Microestrutura de mercado

A microestrutura de mercado é um campo de estudo que analisa os mecanismos e processos pelos quais os preços dos ativos são formados nos mercados financeiros. Este campo abrange uma variedade de tópicos, incluindo a organização e funcionamento dos mercados, o comportamento dos participantes do mercado, e os custos de transação. Segundo Harris (2003), a microestrutura de mercado examina como a estrutura do mercado e os mecanismos de negociação afetam a formação de preços, a liquidez e a eficiência do mercado.

Compreender a microestrutura é fundamental para analisar como as informações são incorporadas nos preços e como os custos de transação influenciam as decisões de investimento. Os mercados financeiros podem ser organizados de várias maneiras, incluindo mercados de leilão e mercados de dealer. Em mercados de leilão, como as bolsas de valores, os preços são estabelecidos através de leilões competitivos, onde compradores e vendedores submetem ordens que são combinadas para formar o preço de mercado. Nos mercados de dealer, como o mercado de câmbio, os dealers fornecem liquidez ao comprar e vender ativos de seu próprio inventário.

Harris (2003) destaca a importância do livro de ordens, que registra todas as ordens de compra e venda pendentes e desempenha um papel crucial na determinação dos preços de mercado. A liquidez do mercado, definida por como a facilidade com que um ativo pode ser comprado ou vendido sem causar uma mudança significativa em seu preço, é fortemente influenciada pela microestrutura do mercado (Harris, 2003). Chordia, et. al (2000) mostram que a estrutura do mercado e a presença de intermediários financeiros desempenham um papel vital na determinação da liquidez. A presença de market makers, por exemplo, pode aumentar a liquidez ao fornecer cotações firmes de compra e venda e ao absorver temporariamente desequilíbrios entre oferta e demanda. Além disso, a profundidade do livro de ordens e a quantidade de informações disponíveis aos participantes do mercado também afetam a liquidez.

Os custos de transação são um componente crucial da microestrutura de mercado e têm um impacto significativo na eficiência do mercado. Stoll (1989) e Glosten e Milgrom (1985) identificam três principais componentes dos custos de transação: custos de processamento das ordens, custos de assimetria de informação e custos de inventário. Os custos de processamento referem-se aos custos operacionais incorridos pelos intermediários ao executar ordens de compra e venda. Os custos de assimetria de informação surgem da incerteza sobre a informação que outros participantes do mercado possuem. Já os custos de inventário são os custos associados à manutenção de um estoque de ativos para facilitar a negociação. A eficiência do mercado é afetada por esses custos, pois eles influenciam a capacidade dos preços refletirem todas as informações disponíveis.

As inovações tecnológicas, particularmente o trading eletrônico e os algoritmos de negociação, têm transformado a microestrutura dos mercados financeiros. Hendershott, Jones e Menkveld (2011) investigam o impacto do trading algorítmico na liquidez do mercado e concluem que ele melhora a liquidez ao aumentar a frequência e a velocidade das transações. A introdução de plataformas de negociação eletrônica reduziu os custos de transação e aumentou a transparência do mercado, permitindo uma melhor incorporação de informações nos preços. No entanto, essas inovações também trazem desafios, como a necessidade de regulamentos adequados para mitigar os riscos associados ao trading de alta frequência e para garantir a estabilidade do mercado.

## Spread de oferta e compra (spread bid-ask)

Custos de inventário ou de estoque, segundo De Jong e Rindi (2009), existem apenas em mercados quote-driven, pois nesses mercados os formadores têm a obrigação de fornecer preços de compra e preços de venda ininterruptamente ao mercado. Os custos relacionados à assimetria de informação e de transação ou de processamento de ordens existem em qualquer mercado. O mercado de ações da B3 é order-driven e nesse caso não se identifica o custo de estoque.

Nos mercados quote-driven, também conhecidos como mercados de dealer, um intermediário (dealer) participa de todas as transações. Nesse tipo de mercado, os traders negociam diretamente com o dealer, que fornece cotações dos preços de compra e venda, assumindo o lado oposto de cada transação e, assim, proporcionando liquidez ao mercado. Esses mercados são comuns no comércio de moedas estrangeiras e títulos no mercado de balcão (OTC).

Por outro lado, nos mercados order-driven, os compradores e vendedores negociam diretamente entre si, sem a intervenção de um dealer, utilizando um conjunto de regras de negociação estabelecidas. Essas regras incluem precedência de ordens, que determina como as ordens de compra e venda são casadas, e regras de precificação de transações. Os mercados order-driven são prevalentes em bolsas de futuros, ações e opções, bem como em redes eletrônicas de comunicação para negociação de títulos e moedas. Em suma, a principal diferença reside no papel do intermediário: enquanto nos mercados quote-driven o dealer facilita todas as transações fornecendo cotações, nos mercados order-driven, as transações são realizadas diretamente entre os traders com base em regras de mercado (Peat, 2009).

No contexto do mercado de ações no Brasil, a B3 adota um modelo de mercado order-driven, mas algumas ações contam com a presença de formadores de mercado. Os formadores de mercado, ou market makers, são contratados pelas empresas para aumentar a liquidez de suas ações. A liquidez refere-se à facilidade com que um ativo pode ser comprado ou vendido sem causar uma mudança significativa em seu preço (Harris, 2003). A presença de um formador de mercado pode reduzir o spread de compra e venda, o que diminui os custos de transação para os investidores e aumenta a atratividade da ação. Empresas contratam formadores de mercado para aumentar a liquidez de suas ações, melhorar a precificação e atrair mais investidores, especialmente em períodos de baixa negociação ou para novos papéis que estão sendo introduzidos no mercado.

A assimetria de informação, por sua vez, ocorre quando diferentes participantes do mercado têm diferentes níveis de acesso à informação relevante para a precificação dos ativos. Nos mercados order-driven, a assimetria de informação pode ser mitigada pela transparência do livro de ordens e pelas regras claras de negociação. No entanto, a assimetria ainda pode existir, especialmente em mercados menos líquidos ou em ações com menor cobertura de analistas. Em mercados quote-driven, a assimetria de informação pode ser mais pronunciada, pois os dealers podem ter acesso a informações privilegiadas que não estão disponíveis para todos os participantes do mercado.

Além disso, os custos de transação referem-se aos custos associados à realização de uma transação econômica, que incluem os custos de negociação e de contratação (Demsetz, 1968). Esses custos incluem taxas pagas à bolsa, comissões de corretagem e custos relacionados ao tempo e esforço necessários para processar as ordens. Em mercados order-driven como a B3, esses custos podem ser reduzidos pela automação e eficiência das plataformas de negociação eletrônica, que facilitam a correspondência rápida e precisa das ordens de compra e venda.

Em suma, a presença de formadores de mercado em ações na B3 visa principalmente aumentar a liquidez, reduzir o spread de compra e venda e melhorar a eficiência do mercado. Ao contratar formadores de mercado, as empresas buscam criar um ambiente de negociação mais ativo e atraente para os investidores, promovendo assim uma melhor precificação e maior volume de negociações. A compreensão dos diferentes custos associados ao spread de compra e venda, bem como das diferenças entre mercados quote-driven e order-driven, é essencial para avaliar o impacto da microestrutura de mercado na formação de preços dos ativos financeiros.

## Revisão de literatura

Para aprofundar a compreensão do tema de pesquisa, foi realizada uma revisão narrativa da literatura nas bases de dados Web of Science, Scopus, Periódicos Capes e Google Scholar. A RNL, diferentemente da RSL, não se baseia em uma metodologia rígida e pré-definida como o PRISMA. Essa abordagem permite uma maior flexibilidade na seleção dos estudos, possibilitando a inclusão de trabalhos que, embora não tenham sido publicados em periódicos indexados, contribuem significativamente para o entendimento do tema.

A escolha da RNL se justifica pela necessidade de construir um panorama mais amplo e abrangente sobre o spread bid-ask no contexto brasileiro, onde a literatura ainda é incipiente. Ao adotar essa abordagem, foi possível identificar tanto os estudos mais recentes e rigorosos quanto aqueles que, por sua natureza exploratória, podem oferecer insights valiosos para a pesquisa.

O processo de revisão narrativa seguiu as seguintes etapas:

1.  Definição da pergunta de pesquisa: O estudo buscou responder à seguinte questão: "O artigo identificou que o spread bid-ask é importante para a formação de preços?".
2.  Elaboração da estratégia de busca: Foram utilizadas palavras-chave específicas, como "\[inserir suas palavras-chave\]", para identificar os estudos relevantes nas bases de dados mencionadas.
3.  Seleção dos estudos: A seleção dos artigos foi realizada com base na relevância para a pergunta de pesquisa e na disponibilidade do texto completo.
4.  Análise narrativa: Os estudos selecionados foram analisados de forma qualitativa, buscando identificar como cada um aborda a relação entre o spread bid-ask e a formação de preços.
5.  Síntese dos achados: Os resultados da análise foram sintetizados, destacando os principais achados, as lacunas na literatura e as implicações para futuras pesquisas. \### Procedimentos e questões de pesquisa

```{r}
TabelaArtigosSeminais <- data.frame(
  Título = c("The Cost of Transacting", 
             "A Simple Implicit Measure of the Effective spread bid-ask in an Efficient Market", 
             "The Components of the spread bid-ask: A General Approach", 
             "A Simple Way to Estimate spread bid-asks from Daily High and Low Prices", 
             "The Effects of Stock Splits on spread bid-asks", 
             "A Simple Estimation of spread bid-asks from Daily Close, High, and Low Prices", 
             "Price, Trade Size and Information in Securities Markets", 
             "Bid, Ask and Transaction Prices in a Specialist Market with Heterogeneously Informed Traders", 
             "A SHARP model of spread bid-ask forecasts", 
             "Efficient Estimation of spread bid-asks from Open, High, Low, and Close Prices",
             "Comparision of spread bid-ask Proxies Evidence From Borsa Istanbul Futures"),
  Autores = c("H. Demsetz", 
              "R. Roll", 
              "R. D. Huang, H. R. Stoll", 
              "S. A. Corwin, P. Schultz", 
              "R. M. Conroy, R. M. Harris, B. A. Benet", 
              "ABDI, F.; RANALDO, A", 
              "EASLEY, D.; O’HARA, M.", 
              "GLOSTEN, L.; MILGROM, P.", 
              "CATTIVELLI, L.; PIRINO, D.", 
              "ARDIA, D.; GUIDOTTI, E.; KROENCKE, T.",
              "GULOGLU, Z.C.; EKINCI, C."),
  Ano = c(1968, 1984, 1997, 2012, 1990, 2017, 1987, 1984, 2019, 2023, 2016)
  )

# Criar a tabela com os dados fornecidos
TabelaArtigosBrasileiros <- data.frame(
  Título = c(
    "The adverse selection cost component of the spread of Brazilian stocks",
    "Corwin-Schultz spread bid-ask Estimator in the Brazilian Stock Market",
    "Asymmetric information and daily stock prices in Brazil",
    "Determinantes da Liquidez de Mercado de Ações Negociadas na BM&FBOVESPA",
    "Como o Fator de Iliquidez afeta o Retorno das Ações Brasileiras - Estudo Empírico",
    "O apreçamento do spread de liquidez no mercado secundário de debêntures",
    "Análise dos principais componentes do spread bid-ask de opções sobre ações no mercado brasileiro",
    "Determinantes da remuneração do spread de certificados de recebíveis do agronegócio no mercado brasileiro"
  ),
  Autores = c(
    "ARAÚJO, G.; BARBEDO, C.; VICENTE, J.",
    "RIPAMONTI, A.",
    "ICHIMURA, D.; VIDEIRA, R.; RIPAMONTI, A.",
    "CORREIA, L.; AMARAL, H.",
    "OLIVEIRA, R.; GONÇALVES, P.; SHENG, H.; PINTO, P.",
    "TOLEDO, R.",
    "PINTO, P.",
    "TOLEDO, R."
  ),
  Ano = c(2014, 2016, 2020, 2014, 2018, 2010, 2018, 2016),
  stringsAsFactors = FALSE
)

# Renderizar a tabela usando gt
gt_TabelaArtigosSeminais <- TabelaArtigosSeminais %>%
  gt() %>%
  tab_header(
    title = "Artigos Seminais Selecionados"
  ) %>%
  cols_label(
    Título = "Título",
    Autores = "Autores",
    Ano = "Ano"
  ) %>%
  cols_width(
    Título ~ px(300),  # Definir a largura da coluna Título
    Autores ~ px(200), # Definir a largura da coluna Autores
    Ano ~ px(50)       # Definir a largura da coluna Ano
  ) %>%
  text_transform(
    locations = cells_body(columns = c(Título, Autores)),
    fn = function(x) {
      gsub(" ", "\n", x)  # Quebrar o texto dentro das células
    }
  )

# Renderizar a tabela usando o pacote gt
gt_TabelaArtigosBrasileiros <- TabelaArtigosBrasileiros %>%
  gt() %>%
  tab_header(
    title = "Artigos Seminais Selecionados"
  ) %>%
  cols_label(
    Título = "Título",
    Autores = "Autores",
    Ano = "Ano"
  ) %>%
  cols_width(
    Título ~ px(300),  # Definir a largura da coluna Título
    Autores ~ px(200), # Definir a largura da coluna Autores
    Ano ~ px(100)       # Definir a largura da coluna Ano
  ) %>%
  tab_source_note(
    source_note = "Fonte: Elaborado pelos autores"
  ) %>%
  fmt_markdown(
    columns = Título
  ) %>%
  text_transform(
    locations = cells_body(columns = Autores),
    fn = function(x) {
      gsub("; ", ";\n", x)  # Quebrar linha após cada ponto e vírgula nos autores
    }
  )


```

::: {#tbl-atgseminal}
```{r}

# Exibir a tabela
gt_TabelaArtigosSeminais
```

Fonte: Elaborado pelos autores

Artigos seminais selecionados
:::

::: {#tbl-atgbrasileiros}
```{r}
# Exibir a tabela
gt_TabelaArtigosBrasileiros
```

Fonte: Elaborado pelos autores

Artigos brasileiros selecionados
:::

### Seleção de artigos

Para a construção desta revisão narrativa de literatura, serão utilizados artigos seminais que estabelecem a base teórica e metodológica do estudo sobre o spread bid-ask. Estes artigos são fundamentais para compreender as evoluções conceituais e as principais contribuições no campo da formação de preços e liquidez de mercado. A @tbl-atgseminal apresenta os artigos seminais selecionados.

Além disso, reconhecendo a necessidade de contextualizar o estudo para o mercado brasileiro, foram incluídos artigos e dissertações que abordassem o spread bid-ask no contexto específico do Brasil. A @tbl-atgbrasileiros lista os estudos brasileiros selecionados, destacando aqueles que oferecem insights específicos sobre as particularidades do mercado financeiro brasileiro.

Os critérios de inclusão e exclusão também foram claramente definidos: foram incluídos estudos que abordassem diretamente a relação entre o *spread bid-ask* e a formação de preços, utilizando uma variedade de metodologias e tipos de dados. Estudos que não apresentavam análise empírica ou que não estavam disponíveis em texto completo foram excluídos. A seleção final dos estudos considerou a relevância para a pergunta de pesquisa principal, "O artigo identificou que *spread bid-ask* é importante para a formação de preços?", e a disponibilidade de acesso ao texto completo.

A @tbl-atgseminal e @tbl-atgbrasileiros mostram em sua totalidade, os estudos que serão abordados e analisados considerando o tema *spread bid-ask* e sua relação com a formação de preços. Todos os estudos estão em concordância com a questão central da pesquisa, e serão analisados considerando a influência direta do spread para a formação de preços.

### Extração de dados

Para esta etapa, foram selecionados 19 artigos que foram integralmente revisados. Com base nessa revisão, extraímos as seguintes informações pertinentes à análise do *spread bid-ask* e sua influência na formação de preços:

-   Quais métodos foram empregados?

-   Quais tipos de dados foram utilizados? Alta ou Baixa frequência.

-   Quais mercados foram examinados?

-   Quais aspectos do *spread bid-ask* foram analisados?

-   O *spread bid-ask* é considerado relevante para a formação de preço?

### Resultados

Os resultados da Revisão Narrativa de Literatura (RNL) sobre o *spread bid-ask* revelam uma diversidade de métodos, tipos de dados, mercados examinados e aspectos analisados. A análise dos artigos selecionados demonstra a complexidade e a importância do *spread bid-ask* nos mercados financeiros, refletindo diferentes abordagens metodológicas e contextos de aplicação.

Os artigos analisados incluem trabalhos como o de Corwin e Schultz (2012), que apresentam um método para estimar o *spread bid-ask* utilizando dados de baixa frequência, e Roll (1984), que introduz um estimador baseado na covariância serial dos retornos. Além disso, estudos de alta frequência, como o de Huang (1997) e Holden e Jacobsen (2014), utilizam dados do livro de ordens para fornecer proxies explícitas do preço fundamental e calcular a distância dos preços de transação a partir dele. A amostra também abrange pesquisas recentes, como a de Ardia, Guidotti e Kroencke (2024), que aplicam estimadores generalizados de spread para analisar a volatilidade e a liquidez nos mercados de ações. A diversidade de metodologias e a aplicação em diferentes contextos de mercado proporcionam uma visão abrangente e detalhada sobre o impacto do *spread bid-ask* na formação de preços de ativos financeiros.

A relação inversa entre a liquidez de um ativo e seu *spread bid-ask* é destacada em pesquisas como as de Roll (1984) e Huang (1997), que demonstram que mercados com spreads menores tendem a ser mais líquidos, permitindo transações com menor impacto nos preços. Pesquisas contemporâneas, como as de Ardia, Guidotti e Kroencke (2024), indicam que o *spread bid-ask* está correlacionado com a volatilidade do mercado. Spreads mais altos frequentemente refletem uma maior incerteza sobre o valor fundamental dos ativos, resultando em maior volatilidade nos preços de mercado. A análise de diferentes mercados, como NYSE, AMEX, NASDAQ e mercados internacionais como Hong Kong e Índia, revela que o impacto do *spread bid-ask* varia conforme as características específicas de cada mercado, incluindo regulação, nível de transparência e estrutura de mercado.

Os métodos empregados nos estudos variaram significativamente, com uma predominância de modelos econométricos, especialmente regressões de Mínimos Quadrados Ordinários (MQO). Outros métodos incluíram a simulação de Monte Carlo para estimar preços de ativos considerando custos transacionais, a metodologia de Fama e MacBeth para analisar variáveis em seções cruzadas e séries temporais, a metodologia de Amihud e Mendelson para calcular o impacto dos custos de transação no *spread bid-ask*, e estimativas implícitas como a de Roll (1984) para calcular spreads a partir de dados de preços diários. Essas abordagens permitiram uma análise abrangente dos fatores que influenciam o *spread bid-ask*, proporcionando uma compreensão aprofundada de sua dinâmica nos mercados financeiros. Embora a maioria dos métodos utilizados fosse econométrica, é importante notar que, dos dez estudos que empregaram métodos econométricos, apenas quatro utilizaram dados de baixa frequência. Destes quatro, dois não foram aplicados ao mercado de ações, mas sim ao mercado de debêntures e ao mercado de certificados de recebíveis do agronegócio.

::: {#img-grafbarravertmetod}
```{r}
# Criar o data frame com os dados
metodologias <- data.frame(
  Categoria = c("Econométrico", "Bid-ask"),
  Valor = c(10, 9)
)

# Criar o gráfico de barras
ggplot(metodologias, aes(x = Categoria, y = Valor, fill = Categoria)) +
  geom_bar(stat = "identity") +
  labs(title = "Metodologias", x = "Categoria", y = "Valor") +
  theme_minimal()
```

Fonte: Elaborado pelos autores

Gráfico de barras de metologias econométricas e de cálculo do spread bid-ask dos artigos analisados no estudo
:::

### Discussão

O objetivo da RNL é identificar o impacto do *spread bid-ask* na formação de preços de ativos financeiros, com foco no mercado de ações, seguindo uma abordagem qualitativa e descritiva que busca explorar e sintetizar os principais achados e teorias relacionadas ao tema. A RNL é interessante por permitir maior flexibilidade na seleção e análise dos estudos, proporcionando uma visão abrangente e interpretativa do fenômeno.

A discussão sobre o *spread bid-ask* é importante porque ele introduz ineficiências no mercado, impedindo que os preços se ajustem rapidamente às novas informações. Isso sugere que, na prática, os mercados podem não ser tão eficientes quanto a teoria propõe, e os investidores precisam considerar esses fatores ao tomar decisões de investimento.

Os resultados deste trabalho sugerem que o *spread bid-ask* desempenha um papel crucial na formação dos preços dos ativos financeiros, afetando tanto a liquidez quanto os custos de transação nos mercados financeiros. A metodologia mais utilizada foi a de regressões de Mínimos Quadrados Ordinários (MQO) para analisar os dados e calcular a influência do spread. Em relação aos tipos de dados utilizados, a maioria dos estudos empregou dados de baixa frequência, como preços diários de abertura, fechamento, máximo e mínimo dos ativos negociados. Os aspectos do *spread bid-ask* analisados foram igualmente variados, mas os estudos focaram principalmente no aspecto do custo de transação. De maneira geral, os estudos concordam que o *spread bid-ask* é um indicador importante de liquidez e custos de transação, influenciando diretamente a eficiência do mercado e a formação de preços.

Considerando a Revisão Narrativa de Literatura, este estudo aplica três métodos e os compara para estimar o spread bid-ask utilizando dados de baixa frequência. A escolha por dados de baixa frequência deve-se à dificuldade de acesso a dados de alta frequência no Brasil, limitando análises mais detalhadas. Além disso, a literatura sobre spread bid-ask no mercado acionário brasileiro é escassa, exigindo a adaptação de métodos utilizados nos EUA para a realidade brasileira.

# Introdução ao trabalho empírico

## Contexto

### Relevância e justificativa

# Objetivos

Considerando a relevância do spread bid-ask na formação de preços de ativos financeiros e seu impacto na liquidez e nos custos de transação, este estudo tem como objetivo geral analisar e comparar metodologias de estimativa do spread bid-ask com os valores de referência fornecidos pela Bloomberg, buscando compreender quais métodos são mais adequados ao mercado de ações brasileiro. Adicionalmente, o trabalho investiga as dinâmicas do spread bid-ask antes, durante e após o período da pandemia de COVID-19, explorando possíveis implicações para a eficiência e liquidez do mercado.

Os objetivos específicos, usados para responder às perguntas de pesquisa serão:

1.  Avaliar qual metodologia de estimativa de spread bid-ask se aproxima mais dos valores de referência fornecidos pela Bloomberg.
2.  Analisar o comportamento do spread bid-ask em três períodos distintos: pré-COVID-19, durante a pandemia e no período pós-COVID-19.
3.  Comparar as vantagens e limitações de estimadores consagrados na literatura, como o EDGE, de Ardia, Guidotti e Kroencke (2024), o Corwin e Schultz (2012) e o Abdi e Ranaldo (2017) em cenários de diferentes frequências de negociação no mercado brasileiro.

# Amostra

# Metodologia

Este estudo aplicou três metodologias amplamente reconhecidas para a estimativa do spread bid-ask: CS, AR e EDGE utilizando dados obtidos diretamente da B3 e validados com referências da Bloomberg. Essas abordagens foram selecionadas devido à sua robustez teórica, ampla aceitação na literatura e capacidade de oferecer insights em diferentes contextos de mercado.

O estimador de spread bid-ask desenvolvido por Corwin e Schultz (2012) utiliza os preços diários de máxima e mínima das ações para calcular o spread de forma simples e eficiente. A metodologia parte de duas premissas principais. Primeiramente, assume-se que os preços máximos tendem a ser resultados de ordens de compra, enquanto os mínimos são influenciados por ordens de venda. Dessa forma, a relação entre os preços de máxima e mínima reflete tanto a volatilidade fundamental do ativo quanto os custos associados ao spread bid-ask. Em segundo lugar, considera-se que a componente de volatilidade aumenta proporcionalmente com o intervalo de negociação, enquanto a parte do spread permanece constante.

O método utiliza fórmulas matemáticas baseadas nos logaritmos dos preços de máxima e mínima ao longo de um ou dois dias consecutivos para separar o impacto da volatilidade do componente relacionado ao spread bid-ask. Além disso, sua implementação é direta, dispensando iterações complexas para ajustar as estimativas. Corwin e Schultz (2012) validaram o estimador em simulações que replicaram condições realistas de mercado. Eles demonstraram que a correlação entre os valores estimados pelo método e os spreads reais é alta, em torno de 0,9. Comparado ao estimador de covariância de Roll (1984), o desvio padrão das estimativas de Corwin e Schultz é cerca de metade, indicando maior estabilidade nos resultados. O método foi aplicado em ações de 11 países, incluindo o Brasil, e se mostrou eficaz em medir os custos de transação em diferentes contextos de liquidez e volatilidade.

Essa metodologia tem sido amplamente utilizada em estudos sobre microestrutura de mercado. Por exemplo, foi empregada para analisar a relação entre qualidade das informações financeiras e assimetria de informações, com resultados que destacaram sua eficiência em comparação com outros indicadores. Embora algumas pesquisas apontem limitações no uso do método como medida de liquidez para prever retornos, ele continua sendo uma ferramenta confiável para estimar custos de transação e compreender a dinâmica de mercados financeiros.

Sendo assim, o estimador de Corwin e Schultz oferece uma solução prática e robusta para medir o spread bid-ask com base em dados diários, sendo amplamente adotado em estudos de microestrutura, especialmente em mercados onde dados intradiários são limitados. Sua simplicidade e eficácia tornam-no uma ferramenta valiosa para analisar a liquidez e eficiência do mercado financeiro brasileiro.

Já o estimador de Abdi e Ranaldo (2017) trouxe uma metodologia nova para o cálculo do spread, sendo desenvolvida para estimar o spread bid-ask utilizando preços diários de fechamento, máxima e mínima das ações. A abordagem se baseia na decomposição do spread em componentes de volatilidade e custos de transação, permitindo uma análise detalhada dos fatores que influenciam a formação de preços nos mercados financeiros. Esse estimador é fundamentado em três etapas principais. Primeiro, utiliza-se o preço médio entre a máxima e a mínima (mid-range) como um proxy para o preço eficiente, supondo que o spread bid-ask se cancela nesse cálculo. Em seguida, calcula-se a distância quadrática entre o preço de fechamento e o proxy de preço eficiente derivado da média das médias de dois dias consecutivos. Por fim, essa distância é ajustada para remover a variância do preço eficiente, isolando assim o componente relacionado ao spread bid-ask. Essa abordagem, além de simplificar cálculos, não requer ajustes *ad hoc* para períodos sem negociação, como finais de semana e feriados, o que a torna menos suscetível a viéses comuns em outros modelos.

Adicionalmente, o modelo de Abdi e Ranaldo (2017) se destaca em cenários de baixa liquidez. Ao contrário do estimador de Corwin-Schultz (2012), que apresenta viés descendente em ativos menos líquidos, esse método AR foi dito como mais estável e robusto em condições de mercado desafiadoras, o tornando uma ferramenta valiosa para analisar a eficiência e a liquidez em mercados emergentes e em desenvolvimento, onde a disponibilidade de dados intradiários é limitada. A relevância desse estimador é evidente ao compará-lo com outros modelos, como o de Corwin-Schultz. Enquanto o estimador de Corwin-Schultz depende de uma estrutura não-linear para decompor a volatilidade do preço e o spread bid-ask, o modelo de Abdi e Ranaldo (2017) utiliza uma solução em forma fechada, simplificando o processo de estimação e reduzindo a necessidade de premissas adicionais, como a igualdade de chances de preços de alta e baixa serem iniciados por compradores ou vendedores.

Além disso, o método é amplamente aplicável, tendo sido validado em Abdi e Ranaldo (2017) em uma extensa amostra de ações nos EUA desde 1926, demonstrando alto grau de correlação com spreads efetivos medidos por dados intradiários (TAQ). Isso confirma sua eficácia como uma ferramenta para mensurar custos de transação e liquidez em longos períodos históricos, contribuindo para a análise de risco de liquidez sistemática e de commonality em liquidez.

O método EDGE, desenvolvido por Ardia, Guidotti e Kroencke (2024), surge como uma proposta robusta para estimar o spread bid-ask de maneira eficiente, utilizando preços diários de abertura, máxima, mínima e fechamento (OHLC). Este método aborda uma limitação crítica de estimadores anteriores, como os de Corwin e Schultz (2012) e Abdi e Ranaldo (2017): o viés introduzido pela suposição de preços observados continuamente, que não reflete a realidade de mercados com baixa frequência de negociações.

O EDGE parte de três premissas centrais, compartilhadas com outros métodos: (1) os retornos fundamentais não são autocorrelacionados; (2) os retornos fundamentais são independentes das flutuações causadas pelo spread bid-ask; e (3) as flutuações do spread não possuem média e são não correlacionadas. No entanto, ele se diferencia ao relaxar a suposição de que preços são continuamente observados. Em mercados reais, a quantidade de negociações por intervalo de tempo é finita, o que resulta em um viés de subestimação dos spreads, especialmente em ativos com baixa liquidez. O EDGE corrige essa limitação introduzindo termos analíticos que ajustam o viés decorrente da observação discreta de preços.

De acordo com Ardia, Guidotti e Kroencke (2024), uma das características mais inovadoras do EDGE é a combinação otimizada de estimadores derivados de diferentes combinações de preços (como abertura e fechamento, máxima e mínima). Isso é feito para minimizar a variância de estimação, resultando em um estimador eficiente que se destaca tanto em cenários de spreads baixos quanto elevados. Segundo o artigo, enquanto estimadores como o de Corwin e Schultz (2012) são mais precisos para spreads pequenos, e o de Abdi e Ranaldo (2017) apresenta menor viés para spreads grandes, o EDGE combina o melhor desses cenários, garantindo estimativas com menor variância e viés uniforme.

Comparando com métodos anteriores, como o de Abdi e Ranaldo, o EDGE generaliza sua abordagem ao considerar informações adicionais de preços de abertura e fechamento. Enquanto o estimador de Abdi e Ranaldo utiliza médias de preços máximos, mínimos e de fechamento para isolar o componente de volatilidade do spread, o EDGE aproveita todas as informações de OHLC e introduz ajustes analíticos para corrigir observações discretas. Além disso, o EDGE não requer ajustes adicionais para períodos sem negociação, como finais de semana e feriados, assim como o estimador de Abdi e Ranaldo.

Sendo assim, o EDGE é uma contribuição relevante para a literatura de microestrutura de mercado, oferecendo uma ferramenta confiável e eficiente para a estimação de custos de transação. Ele não apenas melhora a precisão das estimativas em relação a métodos tradicionais, mas também amplia sua aplicabilidade a diversos contextos de mercado, como períodos históricos e mercados emergentes.

Os três estimadores discutidos – Corwin-Schultz (CS), Abdi-Ranaldo (AR) e EDGE – foram escolhidos para este estudo devido à sua relevância teórica, robustez metodológica e capacidade de oferecer insights em diferentes contextos de mercado. Além disso, suas características complementares permitem uma análise comparativa detalhada de suas performances no mercado brasileiro, que é classificado como emergente.

A aplicação dos métodos será realizada em três períodos distintos: pré-pandemia, durante a pandemia e no pós-pandemia. O período pré-pandemia é caracterizado por uma maior estabilidade econômica e condições de mercado mais previsíveis, oferecendo uma base para avaliar o desempenho dos estimadores em um cenário mais controlado. Durante a pandemia, o mercado foi marcado por alta volatilidade e incertezas, o que representa um contexto de maior desafio para os estimadores, especialmente em ativos menos líquidos. Por fim, o período pós-pandemia reflete um mercado em processo de readaptação, com uma recuperação gradual da liquidez e uma nova estabilidade, permitindo verificar a consistência dos métodos em cenários intermediários.

Com isso, este estudo busca avaliar como cada método se adapta às características específicas do mercado brasileiro e dos diferentes contextos temporais, contribuindo para a literatura de microestrutura ao explorar os pontos fortes e limitações de cada estimador em mercados emergentes e desafiadores.

## Cálculo do spread bid-ask

Utilizando o pacote bidask no ambiente de programação R, foram aplicadas as três metodologias selecionadas: EDGE (Ardia, Guidotti e Kroencke, 2024), CS (Corwin e Schultz, 2012) e AR (Abdi e Ranaldo, 2017). O uso de uma janela móvel de 21 dias, representada pelo parâmetro *width* = 21, foi adotado para garantir consistência metodológica e facilitar a comparação com estudos anteriores, como os de Ardia, Guidotti e Kroencke (2024), que seguem o mesmo princípio. Essa configuração considera 21 dias como equivalente a aproximadamente um mês de negociações, com base na prática padrão em mercados financeiros, onde a média de dias úteis de negociação em um mês é de cerca de 21.

Além disso, no estudo de Ardia, Guidotti e Kroencke (2024), a aplicação do estimador é baseada em períodos de 21 dias úteis para representar um mês de negociações. Essa abordagem é consistente com os trabalhos de Corwin e Schultz (2012) e Abdi e Ranaldo (2017), que também utilizam essa mesma configuração temporal em suas análises e simulações. O objetivo é criar uma unidade temporal padronizada que permita avaliar variações no spread bid-ask de maneira comparável ao longo de diferentes períodos e contextos de negociação.

Essa escolha também facilita a análise do impacto de diferentes frequências de negociação, uma vez que uma janela de 21 dias captura tanto oscilações diárias quanto tendências mais amplas em cenários de alta e baixa liquidez. Portanto, a adoção desse parâmetro não só mantém a consistência com a literatura, mas também reflete práticas amplamente aceitas no campo de microestrutura de mercado, garantindo a robustez e a validade dos resultados obtidos no contexto do mercado brasileiro.

O cálculo foi realizado sobre as séries de preços de abertura, máxima, mínima, fechamento (OHLC) e volumes diários obtidos diretamente da B3. As metodologias foram aplicadas sem modificações adicionais, seguindo rigorosamente os algoritmos descritos nos trabalhos originais, de forma a garantir a comparabilidade com os benchmarks teóricos.

## Comparação com o valor de referência e análise de frequência de negociação

As estimativas obtidas pelas três metodologias foram comparadas com os valores de referência fornecidos pela Bloomberg, considerados o padrão-ouro para a estimativa do spread bid-ask. Para realizar essa análise, os dados da Bloomberg foram importados e integrados à base processada, permitindo a construção de comparativos entre as estimativas calculadas e os valores reportados. Essa integração foi essencial para garantir uma avaliação precisa da performance de cada metodologia em relação a uma referência amplamente reconhecida no mercado financeiro.

Foram utilizadas métricas estatísticas para medir a proximidade das estimativas com os valores de referência, como o erro quadrático médio (MSE), que avalia a magnitude do erro entre as estimativas, e o coeficiente de correlação de Pearson, que mede a força e a direção da associação entre os valores estimados e os da Bloomberg. Esses indicadores forneceram uma base objetiva para identificar as condições em que os estimadores apresentaram melhor ou pior desempenho, destacando suas capacidades e limitações em diferentes contextos de negociação.

Para aprofundar a análise, as ações foram classificadas com base no volume médio diário de negociação, visando compreender o impacto da liquidez sobre o desempenho dos estimadores. Essa classificação utilizou os quantis dos volumes médios para segmentar os ativos em dois grupos principais:

30% com maiores volumes: Representando ações altamente líquidas.

30% com menores volumes: Representando ações com baixa liquidez.

As estimativas de spread foram analisadas separadamente para cada grupo, permitindo observar como os estimadores se comportam em cenários de alta e baixa liquidez. Essa abordagem revelou que o EDGE apresentou maior robustez em ativos com baixa liquidez, graças à sua capacidade de corrigir vieses associados à frequência reduzida de negociações. Em contrapartida, o CS mostrou limitações significativas, com viés descendente em ativos de menor volume, enquanto o AR apresentou resultados intermediários entre os dois métodos.

Essa análise detalhada forneceu insights sobre a adequação das metodologias a diferentes perfis de ativos no mercado brasileiro, reforçando a importância de considerar a liquidez como um fator determinante na escolha de estimadores para spread bid-ask. Além disso, contribuiu para a identificação de metodologias mais robustas para contextos de baixa liquidez, uma característica comum em mercados emergentes.

# Limitações

# Discussão

Ardia, Guidotti e Kroencke (2024) discutem que o EDGE é superior em resultados, principalmente quando se trata de períodos de alta volatilidade...

<!-- Montando a tabela de estatísticas -->

```{r}
# Atribuir grupos de volumes aos dados de spreads
company_spreads_df <- company_spreads_df %>%
  mutate(Group = case_when(
    Company_Code %in% high_volume ~ "Ativos mais líquidos",
    Company_Code %in% low_volume ~ "Ativos menos líquidos",
    TRUE ~ "Todos"
  ))

# Calcular as estatísticas para cada grupo e método com 4 casas decimais
stats_table <- company_spreads_df %>%
  group_by(Group) %>%
  summarise(
    Media_EDGE = mean(Spread_EDGE, na.rm = TRUE),
    DesvPad_EDGE = sd(Spread_EDGE, na.rm = TRUE),
    Mediana_EDGE = median(Spread_EDGE, na.rm = TRUE),
    Maximo_EDGE = max(Spread_EDGE, na.rm = TRUE),
    Minimo_EDGE = min(Spread_EDGE, na.rm = TRUE),
    Media_CS = mean(Spread_CS, na.rm = TRUE),
    DesvPad_CS = sd(Spread_CS, na.rm = TRUE),
    Mediana_CS = median(Spread_CS, na.rm = TRUE),
    Maximo_CS = max(Spread_CS, na.rm = TRUE),
    Minimo_CS = min(Spread_CS, na.rm = TRUE),
    Media_AR = mean(Spread_AR, na.rm = TRUE),
    DesvPad_AR = sd(Spread_AR, na.rm = TRUE),
    Mediana_AR = median(Spread_AR, na.rm = TRUE),
    Maximo_AR = max(Spread_AR, na.rm = TRUE),
    Minimo_AR = min(Spread_AR, na.rm = TRUE)
  ) %>%
  ungroup()

# Atribuir os grupos na ordem desejada
stats_table$Group <- factor(stats_table$Group,
                            levels = c("Ativos mais líquidos",
                                       "Ativos menos líquidos",
                                       "Todos"))

stats_table <- stats_table %>% arrange(Group)

# Dividir a stats_table em duas tabelas separadas
stats_table_EDGE <- stats_table %>%
  select(Group, Media_EDGE, DesvPad_EDGE, Mediana_EDGE, Maximo_EDGE, Minimo_EDGE)

stats_table_CS <- stats_table %>%
  select(Group, Media_CS, DesvPad_CS, Mediana_CS, Maximo_CS, Minimo_CS)

stats_table_AR <- stats_table %>%
  select(Group, Media_AR, DesvPad_AR, Mediana_AR, Maximo_AR, Minimo_AR)

# Criar a tabela para EDGE
tabela_EDGE <- stats_table_EDGE %>%
  gt(rowname_col = "Group") %>%
  tab_spanner(
    label = "EDGE",
    columns = c("Media_EDGE", "DesvPad_EDGE", "Mediana_EDGE", "Maximo_EDGE", "Minimo_EDGE")
  ) %>%
  cols_label(
    Media_EDGE = "Média",
    DesvPad_EDGE = "DesvPad",
    Mediana_EDGE = "Mediana",
    Maximo_EDGE = "Máximo",
    Minimo_EDGE = "Mínimo"
  ) %>%
  cols_width(
    c(Media_EDGE, DesvPad_EDGE, Mediana_EDGE, Maximo_EDGE, Minimo_EDGE) ~ px(80)
  ) %>%
  fmt_number(
    columns = c(Media_EDGE, DesvPad_EDGE, Mediana_EDGE, Maximo_EDGE, Minimo_EDGE),
    decimals = 6
  )

# Criar a tabela para CS
tabela_CS <- stats_table_CS %>%
  gt(rowname_col = "Group") %>%
  tab_spanner(
    label = "CS",
    columns = c("Media_CS", "DesvPad_CS", "Mediana_CS", "Maximo_CS", "Minimo_CS")
  ) %>%
  cols_label(
    Media_CS = "Média",
    DesvPad_CS = "DesvPad",
    Mediana_CS = "Mediana",
    Maximo_CS = "Máximo",
    Minimo_CS = "Mínimo"
  ) %>%
  cols_width(
    c(Media_CS, DesvPad_CS, Mediana_CS, Maximo_CS, Minimo_CS) ~ px(80)
  ) %>%
  fmt_number(
    columns = c(Media_CS, DesvPad_CS, Mediana_CS, Maximo_CS, Minimo_CS),
    decimals = 6
  )

# Criar a tabela para AR
tabela_AR <- stats_table_AR %>%
  gt(rowname_col = "Group") %>%
  tab_spanner(
    label = "AR",
    columns = c("Media_AR", "DesvPad_AR", "Mediana_AR", "Maximo_AR", "Minimo_AR")
  ) %>%
  cols_label(
    Media_AR = "Média",
    DesvPad_AR = "DesvPad",
    Mediana_AR = "Mediana",
    Maximo_AR = "Máximo",
    Minimo_AR = "Mínimo"
  ) %>%
  cols_width(
    c(Media_AR, DesvPad_AR, Mediana_AR, Maximo_AR, Minimo_AR) ~ px(80)
  ) %>%
  fmt_number(
    columns = c(Media_AR, DesvPad_AR, Mediana_AR, Maximo_AR, Minimo_AR),
    decimals = 6
  )

```

::: {#tbl-estatsedge}
```{r}
tabela_EDGE
```

Fonte: Elaborado pelo autor

Tabela indicando as principais estatísticas do método EDGE
:::

::: {#tbl-estatscs}
```{r}
tabela_CS
```

Fonte: Elaborado pelo autor

Tabela indicando as principais estatísticas do método CS
:::

::: {#tbl-estatsar}
```{r}
tabela_AR
```

Fonte: Elaborado pelo autor

Tabela indicando as principais estatísticas do método AR
:::

Como visto na @tbl-estatsedge, @tbl-estatscs e na @tbl-estatsar, ao analisar os resultados obtidos, observa-se que o estimador EDGE apresentou valores mínimos de spread bid-ask de 2.2 \times 10\^{-5} para ativos mais líquidos e 1,6 \times 10\^{-5} para ativos menos líquidos. Em contraste, o estimador CS retornou valores iguais a zero para ambos os grupos de ativos. Esses achados estão em consonância com o exposto por Ardia, Guidotti e Kroencke (2024), que investigaram o desempenho de diferentes estimadores de spread bid-ask em função da frequência de negociações.

Segundo Ardia, Guidotti e Kroencke (2024), enquanto todos os estimadores avaliados são não viesados em cenários com alta frequência de negociações (por exemplo, 390 negociações por dia), suas performances divergem significativamente à medida que essa frequência diminui. Especificamente, o estimador CS apresenta um viés negativo acentuado em frequências menores, chegando a estimar spreads nulos em situações com menos de dez negociações diárias. Isso ocorre devido à forte dependência do CS na suposição de que os ativos são negociados continuamente, o que não é válido em mercados com baixa liquidez.

Por outro lado, o EDGE mantém estimativas não viesadas independentemente do número de negociações, graças a um termo de correção analítico que considera a negociação infrequente. Nossos resultados corroboram essa evidência, mostrando que o EDGE não retorna valores nulos mesmo em ativos com baixa frequência de negociação, ao contrário do CS. Dessa forma, o EDGE se apresenta como uma metodologia mais robusta e apropriada para estimar o spread bid-ask em mercados com ativos menos líquidos.

Esses resultados destacam a importância de selecionar estimadores adequados ao contexto de negociação dos ativos analisados, sendo o EDGE uma alternativa superior ao CS em cenários de baixa liquidez.

# Conclusão

\newpage

# Bibliografia

RYAN, Jeffrey; ULRICH, Joshua. Quantmod: Quantitative Financial Modelling Framework. Disponível em: https://github.com/joshuaulrich/quantmod. Acesso em: 24 nov. 2024.